(function(d,x){typeof exports=="object"&&typeof module<"u"?module.exports=x():typeof define=="function"&&define.amd?define(x):(d=typeof globalThis<"u"?globalThis:d||self,d["quill-image-resizor"]=x())})(this,function(){"use strict";var Be;var d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ue(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var K=Ue;function ze(e){return e}var W=ze,Fe=K,X=Math.max;function qe(e,t,r){return t=X(t===void 0?e.length-1:t,0),function(){for(var i=arguments,s=-1,a=X(i.length-t,0),n=Array(a);++s<a;)n[s]=i[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=i[s];return o[t]=r(n),Fe(e,this,o)}}var Ge=qe;function ke(e){return function(){return e}}var Re=ke,He=typeof d=="object"&&d&&d.Object===Object&&d,V=He,Ne=V,Ke=typeof self=="object"&&self&&self.Object===Object&&self,We=Ne||Ke||Function("return this")(),v=We,Xe=v,Ve=Xe.Symbol,Q=Ve,J=Q,Y=Object.prototype,Qe=Y.hasOwnProperty,Je=Y.toString,O=J?J.toStringTag:void 0;function Ye(e){var t=Qe.call(e,O),r=e[O];try{e[O]=void 0;var i=!0}catch{}var s=Je.call(e);return i&&(t?e[O]=r:delete e[O]),s}var Ze=Ye,et=Object.prototype,tt=et.toString;function rt(e){return tt.call(e)}var it=rt,Z=Q,at=Ze,st=it,nt="[object Null]",ot="[object Undefined]",ee=Z?Z.toStringTag:void 0;function lt(e){return e==null?e===void 0?ot:nt:ee&&ee in Object(e)?at(e):st(e)}var w=lt;function ht(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var p=ht,ct=w,ut=p,dt="[object AsyncFunction]",pt="[object Function]",ft="[object GeneratorFunction]",vt="[object Proxy]";function gt(e){if(!ut(e))return!1;var t=ct(e);return t==pt||t==ft||t==dt||t==vt}var U=gt,yt=v,bt=yt["__core-js_shared__"],_t=bt,z=_t,te=function(){var e=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function $t(e){return!!te&&te in e}var mt=$t,xt=Function.prototype,Ot=xt.toString;function Ct(e){if(e!=null){try{return Ot.call(e)}catch{}try{return e+""}catch{}}return""}var St=Ct,wt=U,jt=mt,Tt=p,At=St,Mt=/[\\^$.*+?()[\]{}|]/g,It=/^\[object .+?Constructor\]$/,Pt=Function.prototype,Et=Object.prototype,Dt=Pt.toString,Bt=Et.hasOwnProperty,Lt=RegExp("^"+Dt.call(Bt).replace(Mt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ut(e){if(!Tt(e)||jt(e))return!1;var t=wt(e)?Lt:It;return t.test(At(e))}var zt=Ut;function Ft(e,t){return e==null?void 0:e[t]}var qt=Ft,Gt=zt,kt=qt;function Rt(e,t){var r=kt(e,t);return Gt(r)?r:void 0}var F=Rt,Ht=F,Nt=function(){try{var e=Ht(Object,"defineProperty");return e({},"",{}),e}catch{}}(),re=Nt,Kt=Re,ie=re,Wt=W,Xt=ie?function(e,t){return ie(e,"toString",{configurable:!0,enumerable:!1,value:Kt(t),writable:!0})}:Wt,Vt=Xt,Qt=800,Jt=16,Yt=Date.now;function Zt(e){var t=0,r=0;return function(){var i=Yt(),s=Jt-(i-r);if(r=i,s>0){if(++t>=Qt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var er=Zt,tr=Vt,rr=er,ir=rr(tr),ar=ir,sr=W,nr=Ge,or=ar;function lr(e,t){return or(nr(e,t,sr),e+"")}var ae=lr;function hr(){this.__data__=[],this.size=0}var cr=hr;function ur(e,t){return e===t||e!==e&&t!==t}var j=ur,dr=j;function pr(e,t){for(var r=e.length;r--;)if(dr(e[r][0],t))return r;return-1}var T=pr,fr=T,vr=Array.prototype,gr=vr.splice;function yr(e){var t=this.__data__,r=fr(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():gr.call(t,r,1),--this.size,!0}var br=yr,_r=T;function $r(e){var t=this.__data__,r=_r(t,e);return r<0?void 0:t[r][1]}var mr=$r,xr=T;function Or(e){return xr(this.__data__,e)>-1}var Cr=Or,Sr=T;function wr(e,t){var r=this.__data__,i=Sr(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var jr=wr,Tr=cr,Ar=br,Mr=mr,Ir=Cr,Pr=jr;function g(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}g.prototype.clear=Tr,g.prototype.delete=Ar,g.prototype.get=Mr,g.prototype.has=Ir,g.prototype.set=Pr;var A=g,Er=A;function Dr(){this.__data__=new Er,this.size=0}var Br=Dr;function Lr(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Ur=Lr;function zr(e){return this.__data__.get(e)}var Fr=zr;function qr(e){return this.__data__.has(e)}var Gr=qr,kr=F,Rr=v,Hr=kr(Rr,"Map"),se=Hr,Nr=F,Kr=Nr(Object,"create"),M=Kr,ne=M;function Wr(){this.__data__=ne?ne(null):{},this.size=0}var Xr=Wr;function Vr(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Qr=Vr,Jr=M,Yr="__lodash_hash_undefined__",Zr=Object.prototype,ei=Zr.hasOwnProperty;function ti(e){var t=this.__data__;if(Jr){var r=t[e];return r===Yr?void 0:r}return ei.call(t,e)?t[e]:void 0}var ri=ti,ii=M,ai=Object.prototype,si=ai.hasOwnProperty;function ni(e){var t=this.__data__;return ii?t[e]!==void 0:si.call(t,e)}var oi=ni,li=M,hi="__lodash_hash_undefined__";function ci(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=li&&t===void 0?hi:t,this}var ui=ci,di=Xr,pi=Qr,fi=ri,vi=oi,gi=ui;function y(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}y.prototype.clear=di,y.prototype.delete=pi,y.prototype.get=fi,y.prototype.has=vi,y.prototype.set=gi;var yi=y,oe=yi,bi=A,_i=se;function $i(){this.size=0,this.__data__={hash:new oe,map:new(_i||bi),string:new oe}}var mi=$i;function xi(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Oi=xi,Ci=Oi;function Si(e,t){var r=e.__data__;return Ci(t)?r[typeof t=="string"?"string":"hash"]:r.map}var I=Si,wi=I;function ji(e){var t=wi(this,e).delete(e);return this.size-=t?1:0,t}var Ti=ji,Ai=I;function Mi(e){return Ai(this,e).get(e)}var Ii=Mi,Pi=I;function Ei(e){return Pi(this,e).has(e)}var Di=Ei,Bi=I;function Li(e,t){var r=Bi(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var Ui=Li,zi=mi,Fi=Ti,qi=Ii,Gi=Di,ki=Ui;function b(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}b.prototype.clear=zi,b.prototype.delete=Fi,b.prototype.get=qi,b.prototype.has=Gi,b.prototype.set=ki;var Ri=b,Hi=A,Ni=se,Ki=Ri,Wi=200;function Xi(e,t){var r=this.__data__;if(r instanceof Hi){var i=r.__data__;if(!Ni||i.length<Wi-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ki(i)}return r.set(e,t),this.size=r.size,this}var Vi=Xi,Qi=A,Ji=Br,Yi=Ur,Zi=Fr,ea=Gr,ta=Vi;function _(e){var t=this.__data__=new Qi(e);this.size=t.size}_.prototype.clear=Ji,_.prototype.delete=Yi,_.prototype.get=Zi,_.prototype.has=ea,_.prototype.set=ta;var ra=_,le=re;function ia(e,t,r){t=="__proto__"&&le?le(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var q=ia,aa=q,sa=j;function na(e,t,r){(r!==void 0&&!sa(e[t],r)||r===void 0&&!(t in e))&&aa(e,t,r)}var he=na;function oa(e){return function(t,r,i){for(var s=-1,a=Object(t),n=i(t),o=n.length;o--;){var l=n[e?o:++s];if(r(a[l],l,a)===!1)break}return t}}var la=oa,ha=la,ca=ha(),ua=ca,P={exports:{}};P.exports,function(e,t){var r=v,i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===i,n=a?r.Buffer:void 0,o=n?n.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var f=c.length,m=o?o(f):new c.constructor(f);return c.copy(m),m}e.exports=l}(P,P.exports);var da=P.exports,pa=v,fa=pa.Uint8Array,va=fa,ce=va;function ga(e){var t=new e.constructor(e.byteLength);return new ce(t).set(new ce(e)),t}var ya=ga,ba=ya;function _a(e,t){var r=t?ba(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var $a=_a;function ma(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var xa=ma,Oa=p,ue=Object.create,Ca=function(){function e(){}return function(t){if(!Oa(t))return{};if(ue)return ue(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Sa=Ca;function wa(e,t){return function(r){return e(t(r))}}var ja=wa,Ta=ja,Aa=Ta(Object.getPrototypeOf,Object),de=Aa,Ma=Object.prototype;function Ia(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Ma;return e===r}var pe=Ia,Pa=Sa,Ea=de,Da=pe;function Ba(e){return typeof e.constructor=="function"&&!Da(e)?Pa(Ea(e)):{}}var La=Ba;function Ua(e){return e!=null&&typeof e=="object"}var C=Ua,za=w,Fa=C,qa="[object Arguments]";function Ga(e){return Fa(e)&&za(e)==qa}var ka=Ga,fe=ka,Ra=C,ve=Object.prototype,Ha=ve.hasOwnProperty,Na=ve.propertyIsEnumerable,Ka=fe(function(){return arguments}())?fe:function(e){return Ra(e)&&Ha.call(e,"callee")&&!Na.call(e,"callee")},ge=Ka,Wa=Array.isArray,ye=Wa,Xa=9007199254740991;function Va(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Xa}var be=Va,Qa=U,Ja=be;function Ya(e){return e!=null&&Ja(e.length)&&!Qa(e)}var G=Ya,Za=G,es=C;function ts(e){return es(e)&&Za(e)}var rs=ts,E={exports:{}};function is(){return!1}var as=is;E.exports,function(e,t){var r=v,i=as,s=t&&!t.nodeType&&t,a=s&&!0&&e&&!e.nodeType&&e,n=a&&a.exports===s,o=n?r.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||i;e.exports=c}(E,E.exports);var _e=E.exports,ss=w,ns=de,os=C,ls="[object Object]",hs=Function.prototype,cs=Object.prototype,$e=hs.toString,us=cs.hasOwnProperty,ds=$e.call(Object);function ps(e){if(!os(e)||ss(e)!=ls)return!1;var t=ns(e);if(t===null)return!0;var r=us.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&$e.call(r)==ds}var fs=ps,vs=w,gs=be,ys=C,bs="[object Arguments]",_s="[object Array]",$s="[object Boolean]",ms="[object Date]",xs="[object Error]",Os="[object Function]",Cs="[object Map]",Ss="[object Number]",ws="[object Object]",js="[object RegExp]",Ts="[object Set]",As="[object String]",Ms="[object WeakMap]",Is="[object ArrayBuffer]",Ps="[object DataView]",Es="[object Float32Array]",Ds="[object Float64Array]",Bs="[object Int8Array]",Ls="[object Int16Array]",Us="[object Int32Array]",zs="[object Uint8Array]",Fs="[object Uint8ClampedArray]",qs="[object Uint16Array]",Gs="[object Uint32Array]",h={};h[Es]=h[Ds]=h[Bs]=h[Ls]=h[Us]=h[zs]=h[Fs]=h[qs]=h[Gs]=!0,h[bs]=h[_s]=h[Is]=h[$s]=h[Ps]=h[ms]=h[xs]=h[Os]=h[Cs]=h[Ss]=h[ws]=h[js]=h[Ts]=h[As]=h[Ms]=!1;function ks(e){return ys(e)&&gs(e.length)&&!!h[vs(e)]}var Rs=ks;function Hs(e){return function(t){return e(t)}}var Ns=Hs,D={exports:{}};D.exports,function(e,t){var r=V,i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===i,n=a&&r.process,o=function(){try{var l=s&&s.require&&s.require("util").types;return l||n&&n.binding&&n.binding("util")}catch{}}();e.exports=o}(D,D.exports);var Ks=D.exports,Ws=Rs,Xs=Ns,me=Ks,xe=me&&me.isTypedArray,Vs=xe?Xs(xe):Ws,Oe=Vs;function Qs(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Ce=Qs,Js=q,Ys=j,Zs=Object.prototype,en=Zs.hasOwnProperty;function tn(e,t,r){var i=e[t];(!(en.call(e,t)&&Ys(i,r))||r===void 0&&!(t in e))&&Js(e,t,r)}var rn=tn,an=rn,sn=q;function nn(e,t,r,i){var s=!r;r||(r={});for(var a=-1,n=t.length;++a<n;){var o=t[a],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),s?sn(r,o,l):an(r,o,l)}return r}var on=nn;function ln(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var hn=ln,cn=9007199254740991,un=/^(?:0|[1-9]\d*)$/;function dn(e,t){var r=typeof e;return t=t??cn,!!t&&(r=="number"||r!="symbol"&&un.test(e))&&e>-1&&e%1==0&&e<t}var Se=dn,pn=hn,fn=ge,vn=ye,gn=_e,yn=Se,bn=Oe,_n=Object.prototype,$n=_n.hasOwnProperty;function mn(e,t){var r=vn(e),i=!r&&fn(e),s=!r&&!i&&gn(e),a=!r&&!i&&!s&&bn(e),n=r||i||s||a,o=n?pn(e.length,String):[],l=o.length;for(var c in e)(t||$n.call(e,c))&&!(n&&(c=="length"||s&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||yn(c,l)))&&o.push(c);return o}var xn=mn;function On(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Cn=On,Sn=p,wn=pe,jn=Cn,Tn=Object.prototype,An=Tn.hasOwnProperty;function Mn(e){if(!Sn(e))return jn(e);var t=wn(e),r=[];for(var i in e)i=="constructor"&&(t||!An.call(e,i))||r.push(i);return r}var In=Mn,Pn=xn,En=In,Dn=G;function Bn(e){return Dn(e)?Pn(e,!0):En(e)}var we=Bn,Ln=on,Un=we;function zn(e){return Ln(e,Un(e))}var Fn=zn,je=he,qn=da,Gn=$a,kn=xa,Rn=La,Te=ge,Ae=ye,Hn=rs,Nn=_e,Kn=U,Wn=p,Xn=fs,Vn=Oe,Me=Ce,Qn=Fn;function Jn(e,t,r,i,s,a,n){var o=Me(e,r),l=Me(t,r),c=n.get(l);if(c){je(e,r,c);return}var u=a?a(o,l,r+"",e,t,n):void 0,f=u===void 0;if(f){var m=Ae(l),N=!m&&Nn(l),Le=!m&&!N&&Vn(l);u=l,m||N||Le?Ae(o)?u=o:Hn(o)?u=kn(o):N?(f=!1,u=qn(l,!0)):Le?(f=!1,u=Gn(l,!0)):u=[]:Xn(l)||Te(l)?(u=o,Te(o)?u=Qn(o):(!Wn(o)||Kn(o))&&(u=Rn(l))):f=!1}f&&(n.set(l,u),s(u,l,i,a,n),n.delete(l)),je(e,r,u)}var Yn=Jn,Zn=ra,eo=he,to=ua,ro=Yn,io=p,ao=we,so=Ce;function Ie(e,t,r,i,s){e!==t&&to(t,function(a,n){if(s||(s=new Zn),io(a))ro(e,t,n,r,Ie,i,s);else{var o=i?i(so(e,n),a,n+"",e,t,s):void 0;o===void 0&&(o=a),eo(e,n,o)}},ao)}var Pe=Ie,no=Pe,Ee=p;function De(e,t,r,i,s,a){return Ee(e)&&Ee(t)&&(a.set(t,e),no(e,t,void 0,De,a),a.delete(t)),e}var oo=De,lo=j,ho=G,co=Se,uo=p;function po(e,t,r){if(!uo(r))return!1;var i=typeof t;return(i=="number"?ho(r)&&co(t,r.length):i=="string"&&t in r)?lo(r[t],e):!1}var fo=po,vo=ae,go=fo;function yo(e){return vo(function(t,r){var i=-1,s=r.length,a=s>1?r[s-1]:void 0,n=s>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(s--,a):void 0,n&&go(r[0],r[1],n)&&(a=s<3?void 0:a,s=1),t=Object(t);++i<s;){var o=r[i];o&&e(t,o,i,a)}return t})}var bo=yo,_o=Pe,$o=bo,mo=$o(function(e,t,r,i){_o(e,t,r,i)}),xo=mo,Oo=K,Co=ae,So=oo,wo=xo,jo=Co(function(e){return e.push(void 0,So),Oo(wo,void 0,e)}),To=jo;const Ao=x(To),Mo={modules:["DisplaySize","Toolbar","Resize"],overlayStyles:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"},handleStyles:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},displayStyles:{position:"absolute",font:"12px/1.0 Arial, Helvetica, sans-serif",padding:"4px 8px",textAlign:"center",backgroundColor:"white",color:"#333",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80",cursor:"default"},toolbarStyles:{position:"absolute",top:"-12px",right:"0",left:"0",height:"0",minWidth:"100px",font:"12px/1.0 Arial, Helvetica, sans-serif",textAlign:"center",color:"#333",boxSizing:"border-box",cursor:"default"},toolbarButtonStyles:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"},toolbarButtonSvgStyles:{fill:"#444",stroke:"#444",strokeWidth:"2"}};class k{constructor(t){this.onCreate=()=>{},this.onDestroy=()=>{},this.onUpdate=()=>{},this.overlay=t.overlay,this.img=t.img,this.options=t.options,this.requestUpdate=t.onUpdate}}class Io extends k{constructor(t){super(t),this.display=null,this.onCreate=()=>{var r;this.display=document.createElement("div"),Object.assign(this.display.style,this.options.displayStyles),(r=this.overlay)==null||r.appendChild(this.display)},this.onDestroy=()=>{},this.onUpdate=()=>{if(!this.display||!this.img)return;const r=this.getCurrentSize();if(this.display.innerHTML=r.join(" &times; "),r[0]>120&&r[1]>30)Object.assign(this.display.style,{right:"4px",bottom:"4px",left:"auto"});else if(this.img.style.float=="right"){const i=this.display.getBoundingClientRect();Object.assign(this.display.style,{right:"auto",bottom:`-${i.height+4}px`,left:`-${i.width+4}px`})}else{const i=this.display.getBoundingClientRect();Object.assign(this.display.style,{right:`-${i.width+4}px`,bottom:`-${i.height+4}px`,left:"auto"})}},this.getCurrentSize=()=>{var r;return[((r=this.img)==null?void 0:r.width)||0,this.img?Math.round(this.img.width/this.img.naturalWidth*this.img.naturalHeight):0]}}}const Po=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>
</svg>`,Eo=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>
</svg>`,Do=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>
</svg>`,R=window.Quill.imports.parchment,$=new R.StyleAttributor("float","float"),S=new R.StyleAttributor("margin","margin"),B=new R.StyleAttributor("display","display");class Bo extends k{constructor(t){super(t),this.alignments=[],this.onCreate=()=>{var r;this.toolbar=document.createElement("div"),Object.assign(this.toolbar.style,this.options.toolbarStyles),(r=this.overlay)==null||r.appendChild(this.toolbar),this._defineAlignments(),this._addToolbarButtons()},this.onDestroy=()=>{},this.onUpdate=()=>{},this._defineAlignments=()=>{this.alignments=[{icon:Po,apply:()=>{B.add(this.img,"inline"),$.add(this.img,"left"),S.add(this.img,"0 1em 1em 0")},isApplied:()=>$.value(this.img)==="left"},{icon:Eo,apply:()=>{B.add(this.img,"block"),$.remove(this.img),S.add(this.img,"auto")},isApplied:()=>S.value(this.img)==="auto"},{icon:Do,apply:()=>{B.add(this.img,"inline"),$.add(this.img,"right"),S.add(this.img,"0 0 1em 1em")},isApplied:()=>$.value(this.img)==="right"}]},this._addToolbarButtons=()=>{const r=[];this.alignments.forEach((i,s)=>{var n;const a=document.createElement("span");r.push(a),a.innerHTML=i.icon,a.addEventListener("click",()=>{r.forEach(o=>o.style.filter=""),i.isApplied()?($.remove(this.img),S.remove(this.img),B.remove(this.img)):(this._selectButton(a),i.apply()),this.requestUpdate()}),Object.assign(a.style,this.options.toolbarButtonStyles),s>0&&(a.style.borderLeftWidth="0"),Object.assign(a.children[0].style,this.options.toolbarButtonSvgStyles),i.isApplied()&&this._selectButton(a),(n=this.toolbar)==null||n.appendChild(a)})},this._selectButton=r=>{r.style.filter="invert(20%)"}}}class Lo extends k{constructor(t){super(t),this.boxes=[],this.dragBox=null,this.dragStartX=0,this.preDragWidth=0,this.onCreate=()=>{this.boxes=[],this.addBox("nwse-resize"),this.addBox("nesw-resize"),this.addBox("nwse-resize"),this.addBox("nesw-resize"),this.positionBoxes()},this.onDestroy=()=>{this.setCursor("")},this.positionBoxes=()=>{var s,a;const r=`${-parseFloat(((s=this.options.handleStyles)==null?void 0:s.width.toString())||"0")/2}px`,i=`${-parseFloat(((a=this.options.handleStyles)==null?void 0:a.height.toString())||"0")/2}px`;[{left:r,top:i},{right:r,top:i},{right:r,bottom:i},{left:r,bottom:i}].forEach((n,o)=>{Object.assign(this.boxes[o].style,n)})},this.addBox=r=>{var s,a,n;const i=document.createElement("div");Object.assign(i.style,this.options.handleStyles),i.style.cursor=r,i.style.width=`${((s=this.options.handleStyles)==null?void 0:s.width)||0}px`,i.style.height=`${((a=this.options.handleStyles)==null?void 0:a.height)||0}px`,i.addEventListener("mousedown",this.handleMousedown,!1),(n=this.overlay)==null||n.appendChild(i),this.boxes.push(i)},this.handleMousedown=r=>{var i,s;this.dragBox=r.target,this.dragStartX=r.clientX,this.preDragWidth=((i=this.img)==null?void 0:i.width)||((s=this.img)==null?void 0:s.naturalWidth)||0,this.setCursor(this.dragBox.style.cursor),document.addEventListener("mousemove",this.handleDrag,!1),document.addEventListener("mouseup",this.handleMouseup,!1)},this.handleMouseup=()=>{this.setCursor(""),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleMouseup)},this.handleDrag=r=>{if(!this.img)return;const i=r.clientX-this.dragStartX;this.dragBox===this.boxes[0]||this.dragBox===this.boxes[3]?this.img.width=Math.round(this.preDragWidth-i):this.img.width=Math.round(this.preDragWidth+i),this.requestUpdate()},this.setCursor=r=>{[document.body,this.img].forEach(s=>{s&&(s.style.cursor=r)})}}}const Uo=Object.freeze(["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"]),zo={DisplaySize:Io,Toolbar:Bo,Resize:Lo},H=class H{constructor(t,r={}){var s;this.moduleClasses=[],this.modules=[],this.onUpdate=()=>{this.repositionElements(),this.modules.forEach(a=>{a.onUpdate()})},this.removeModules=()=>{this.modules.forEach(a=>{a.onDestroy()}),this.modules=[]},this.handleClick=a=>{var o;const n=a.target;if(((o=n==null?void 0:n.tagName)==null?void 0:o.toUpperCase())==="IMG"){if(this.img===n)return;this.img&&this.hide(),this.show(n)}else this.img&&this.hide()},this.show=a=>{this.img=a,this.showOverlay(),this.initializeModules()},this.showOverlay=()=>{this.overlay&&this.hideOverlay(),this.quill.setSelection(null),this.setUserSelect("none"),document.addEventListener("keyup",this.checkImageKeyUp,!0),this.quill.root.addEventListener("input",this.checkImageInput,!0),this.overlay=document.createElement("div"),this.overlay.classList.add("ql-image-resizor"),Object.assign(this.overlay.style,this.options.overlayStyles),this.quill.root.parentNode.appendChild(this.overlay),this.repositionElements()},this.hideOverlay=()=>{this.overlay&&(this.quill.root.parentNode.removeChild(this.overlay),this.overlay=void 0,document.removeEventListener("keyup",this.checkImageKeyUp),this.quill.root.removeEventListener("input",this.checkImageInput),this.setUserSelect(""))},this.repositionElements=()=>{if(!this.overlay||!this.img)return;const a=this.quill.root.parentNode,n=this.img.getBoundingClientRect(),o=a.getBoundingClientRect();Object.assign(this.overlay.style,{left:`${n.left-o.left-1+a.scrollLeft}px`,top:`${n.top-o.top+a.scrollTop}px`,width:`${n.width}px`,height:`${n.height}px`})},this.hide=()=>{this.hideOverlay(),this.removeModules(),this.img=void 0},this.setUserSelect=a=>{Uo.forEach(n=>{this.quill.root.style[n]=a,document.documentElement.style[n]=a})},this.checkImageKeyUp=a=>{var n;if(this.img){if(["Backspace","Delete"].includes(a.code)){const o=(n=window.Quill)==null?void 0:n.find(this.img);o&&o.deleteAt(0)}this.hide()}},this.checkImageInput=a=>{var n;if(this.img){if(["deleteContentForward","deleteContentBackward"].includes(a.inputType)){const o=(n=window.Quill)==null?void 0:n.find(this.img);o&&o.deleteAt(0)}this.hide()}},this.initializeModules=this.initializeModules.bind(this),this.quill=t,this.options=Ao({},r,Mo),(s=r.modules)!=null&&s.length&&(this.moduleClasses=r.modules.slice()),this.quill.root.addEventListener("click",this.handleClick,!1);const i=this.quill.root.parentNode;i.style.position=i.style.position||"relative",this.modules=[],this.moduleClasses=this.options.modules||[]}initializeModules(){var t;this.removeModules(),this.modules=((t=this.moduleClasses)==null?void 0:t.map(r=>new(zo[r]||r)(this)))||[],this.modules.forEach(r=>{r.onCreate()}),this.onUpdate()}};H.Quill=window.Quill;let L=H;return(Be=window.Quill)==null||Be.register("modules/imageResizor",L),L});
